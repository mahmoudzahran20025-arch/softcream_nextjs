# ๐ฏ ุฎุทุฉ ูุธุงู ุงูููุชุฌุงุช ุงูุดุงููุฉ - Master Plan

## ๐ ุชุญููู ุงููุถุน ุงูุญุงูู

### ุงูููุชุฌุงุช ุงูููุฌูุฏุฉ ุญุงููุงู:
| ุงูููุชุฌ | ุงููุฆุฉ | is_customizable | ุงูุณุนุฑ |
|--------|-------|-----------------|-------|
| ููุจ ุณููุช ุณูุฑู ูุฎุตุต | ุณููุช ุณูุฑู | โ 1 | 45 |
| ูุงููููุง ููุงุณูู | ุฃูุจุงู | โ 1 | 25 |
| ุดููู ุจูุฏู | ุดููููุงุชุฉ | โ 0 | 34 |
| ุจุฑุงููู ูุฏุฌ | ูุนุฌูุงุช | โ 0 | 40 |
| ... ุจุงูู ุงูููุชุฌุงุช | ูุชููุนุฉ | โ 0 | ูุชููุน |

### ุงูุจููุฉ ุงูุญุงููุฉ ููู Database:
```
products (ุฌุฏูู ุงูููุชุฌุงุช)
โโโ is_customizable (0 ุฃู 1)
โโโ category / categoryEn
โโโ nutrition columns (calories, protein, etc.)
โโโ allowed_addons (ูููุธุงู ุงููุฏูู)

option_groups (ูุฌููุนุงุช ุงูุฎูุงุฑุงุช)
โโโ flavors (ุงููููุงุช)
โโโ sauces (ุงูุตูุตุงุช)
โโโ dry_toppings (ุงูุฅุถุงูุงุช ุงูููุฑูุดุฉ)

options (ุงูุฎูุงุฑุงุช)
โโโ 7 ูููุงุช ูุน nutrition data
โโโ 5 ุตูุตุงุช
โโโ 7 ุฅุถุงูุงุช ููุฑูุดุฉ

product_options (ููุงุนุฏ ุงูุชุฎุตูุต)
โโโ ุฑุจุท ุงูููุชุฌ ุจูุฌููุนุงุช ุงูุฎูุงุฑุงุช + ุงูููุงุนุฏ
```

---

## ๐ฏ ุงููุชุทูุจุงุช ุงูุฌุฏูุฏุฉ

### 1๏ธโฃ ุฃููุงุน ููุชุฌุงุช ุงูุขูุณ ูุฑูู:

#### A. ุขูุณ ูุฑูู ูุฎุตุต (BYO - Build Your Own)
- **ุงูุญุงููุฉ:** ููุจ ุฃู ููู (Cone)
- **ุงูููุงุณุงุช:** ุตุบูุฑ / ูุณุท / ูุจูุฑ
- **ุงููููุงุช:** ุงุฎุชูุงุฑ 1-2 ูููุฉ
- **ุงูุตูุตุงุช:** ุงุฎุชูุงุฑู 0-2
- **ุงูุฅุถุงูุงุช:** ุงุฎุชูุงุฑู 0-3
- **ุงูููู ุงูุบุฐุงุฆูุฉ:** ุชูุญุณุจ ุฏููุงููููุงู ูู ุงูุงุฎุชูุงุฑุงุช
- **ุงูู UI:** ูุงุฌูุฉ "ุงุตูุน ุงูุขูุณ ูุฑูู ุงูุฎุงุต ุจู" โจ

#### B. ุขูุณ ูุฑูู ุฌุงูุฒ ูุน ุฅุถุงูุงุช
- **ุงูููุชุฌ:** ุขูุณ ูุฑูู ูุญุฏุฏ ูุณุจูุงู (ูุซู: ูุงููููุง ููุงุณูู)
- **ุงูููุงุณุงุช:** ุตุบูุฑ / ูุณุท / ูุจูุฑ
- **ุงูุฅุถุงูุงุช:** ูุงุฆูุฉ ูุญุฏุฏุฉ (ููุณุช BYO ูุงููุฉ)
- **ุงูููู ุงูุบุฐุงุฆูุฉ:** ุซุงุจุชุฉ ููููุชุฌ ุงูุฃุณุงุณู + ุงูุฅุถุงูุงุช
- **ุงูู UI:** ูุงุฌูุฉ "ุฅุถุงูุงุช" ุนุงุฏูุฉ

### 2๏ธโฃ ููุชุฌุงุช ุฃุฎุฑู (ูููู ุดููุ ุญูููุงุชุ ุฅูุฎ):
- **ุงูููุงุณุงุช:** ุญุณุจ ุงูููุชุฌ
- **ุงูุฅุถุงูุงุช:** ูุงุฆูุฉ ูุญุฏุฏุฉ ููู ููุชุฌ
- **ุงูููู ุงูุบุฐุงุฆูุฉ:** ุซุงุจุชุฉ
- **ุงูู UI:** ูุงุฌูุฉ ูุฎุชููุฉ ุนู ุงูุขูุณ ูุฑูู

---

## ๐๏ธ ุงููููู ุงูููุชุฑุญ

### Database Schema Updates:

```sql
-- 1. ุฅุถุงูุฉ ุฌุฏูู ุงูููุงุณุงุช
CREATE TABLE IF NOT EXISTS product_sizes (
  id TEXT PRIMARY KEY,
  product_id TEXT NOT NULL,
  name_ar TEXT NOT NULL,
  name_en TEXT NOT NULL,
  price_modifier REAL DEFAULT 0,  -- ุฒูุงุฏุฉ/ููุตุงู ูู ุงูุณุนุฑ
  multiplier REAL DEFAULT 1,       -- ูุถุงุนู ูููููุฉ (ููู nutrition)
  display_order INTEGER DEFAULT 0,
  is_default INTEGER DEFAULT 0,
  FOREIGN KEY (product_id) REFERENCES products(id)
);

-- 2. ุฅุถุงูุฉ ุฌุฏูู ุฃููุงุน ุงูุญุงููุงุช (ููุขูุณ ูุฑูู)
CREATE TABLE IF NOT EXISTS container_types (
  id TEXT PRIMARY KEY,
  name_ar TEXT NOT NULL,
  name_en TEXT NOT NULL,
  price_modifier REAL DEFAULT 0,
  image TEXT,
  calories INTEGER DEFAULT 0,      -- ุงูููู ูู ุณุนุฑุงุช!
  display_order INTEGER DEFAULT 0
);

-- 3. ุชุญุฏูุซ ุฌุฏูู ุงูููุชุฌุงุช
ALTER TABLE products ADD COLUMN product_type TEXT DEFAULT 'standard';
-- product_type: 'byo_ice_cream', 'preset_ice_cream', 'milkshake', 'dessert', 'standard'

ALTER TABLE products ADD COLUMN has_sizes INTEGER DEFAULT 0;
ALTER TABLE products ADD COLUMN has_container_choice INTEGER DEFAULT 0;

-- 4. ุฑุจุท ุงูููุชุฌุงุช ุจุงูุญุงููุงุช
CREATE TABLE IF NOT EXISTS product_containers (
  product_id TEXT NOT NULL,
  container_id TEXT NOT NULL,
  PRIMARY KEY (product_id, container_id),
  FOREIGN KEY (product_id) REFERENCES products(id),
  FOREIGN KEY (container_id) REFERENCES container_types(id)
);
```

### Product Types (ุฃููุงุน ุงูููุชุฌุงุช):

| Type | ุงููุตู | ุงูููุงุณุงุช | ุงูุญุงููุฉ | ุงูุชุฎุตูุต | ุงูููู ุงูุบุฐุงุฆูุฉ |
|------|-------|----------|---------|---------|----------------|
| `byo_ice_cream` | ุขูุณ ูุฑูู ูุฎุตุต | โ | โ ููุจ/ููู | โ ูุงูู | ุฏููุงููููุฉ |
| `preset_ice_cream` | ุขูุณ ูุฑูู ุฌุงูุฒ | โ | โ | ุฅุถุงูุงุช ููุท | ุซุงุจุชุฉ + ุฅุถุงูุงุช |
| `milkshake` | ูููู ุดูู | โ | โ | ุฅุถุงูุงุช ููุท | ุซุงุจุชุฉ |
| `dessert` | ุญูููุงุช | โ | โ | ุฅุถุงูุงุช ููุท | ุซุงุจุชุฉ |
| `standard` | ููุชุฌ ุนุงุฏู | โ | โ | โ | ุซุงุจุชุฉ |

---

## ๐จ UI Templates (ููุงูุจ ุงููุงุฌูุฉ)

### Template 1: BYO Ice Cream (ุขูุณ ูุฑูู ูุฎุตุต)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ฆ ุงุตูุน ุงูุขูุณ ูุฑูู ุงูุฎุงุต ุจู        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ฆ ุงุฎุชุฑ ุงูุญุงููุฉ:                    โ
โ   [๐ฅค ููุจ] [๐ฆ ููู]                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงุฎุชุฑ ุงูููุงุณ:                     โ
โ   [ุตุบูุฑ 35] [ูุณุท 45] [ูุจูุฑ 55]     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐จ ุงุฎุชุฑ ุงููููุงุช (1-2):              โ
โ   โ ูุงููููุง  โ ุดููููุงุชุฉ  โ ุชูุช     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ซ ุฃุถู ุตูุต (ุงุฎุชูุงุฑู):               โ
โ   โ ุดููููุงุชุฉ  โ ูุฑุงููู  โ ูุฑุงููุฉ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ช ุฅุถุงูุงุช ููุฑูุดุฉ (ุงุฎุชูุงุฑู):         โ
โ   โ ุฃูุฑูู  โ ููุชุณ  โ ููุณุฑุงุช        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงูููู ุงูุบุฐุงุฆูุฉ:                  โ
โ   ๐ฅ 423 cal  ๐ช 7.3g  ๐ 52g       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ฐ ุงูุฅุฌูุงูู: 65 ุฑ.ุณ                 โ
โ        [โ ุฃุถู ููุณูุฉ]               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Template 2: Preset Ice Cream (ุขูุณ ูุฑูู ุฌุงูุฒ)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐จ ูุงููููุง ููุงุณูู                   โ
โ ุตูุฑุฉ ุงูููุชุฌ                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงุฎุชุฑ ุงูููุงุณ:                     โ
โ   [ุตุบูุฑ 25] [ูุณุท 35] [ูุจูุฑ 45]     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โ ุฅุถุงูุงุช:                          โ
โ   โ ุตูุต ุดููููุงุชุฉ +5                 โ
โ   โ ุฃูุฑูู +8                        โ
โ   โ ููุณุฑุงุช +10                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงูููู ุงูุบุฐุงุฆูุฉ:                  โ
โ   ๐ฅ 207 cal  ๐ช 3.5g  ๐ 24g       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ฐ ุงูุฅุฌูุงูู: 35 ุฑ.ุณ                 โ
โ        [โ ุฃุถู ููุณูุฉ]               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Template 3: Milkshake (ูููู ุดูู)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ฅค ูููู ุดูู ุดููููุงุชุฉ                โ
โ ุตูุฑุฉ ุงูููุชุฌ                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงุฎุชุฑ ุงูููุงุณ:                     โ
โ   [ุนุงุฏู 30] [ูุจูุฑ 40]              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โ ุฅุถุงูุงุช:                          โ
โ   โ ูุฑููุฉ ูุฎูููุฉ +5                 โ
โ   โ ุขูุณ ูุฑูู ุฅุถุงูู +10              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงูููู ุงูุบุฐุงุฆูุฉ:                  โ
โ   ๐ฅ 350 cal  ๐ช 8g  ๐ 45g         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ฐ ุงูุฅุฌูุงูู: 40 ุฑ.ุณ                 โ
โ        [โ ุฃุถู ููุณูุฉ]               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### Template 4: Standard Product (ููุชุฌ ุนุงุฏู)
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ๐ฐ ุจุฑุงููู ูุฏุฌ                       โ
โ ุตูุฑุฉ ุงูููุชุฌ                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ุงููุตู ูุงูุชูุงุตูู                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ ุงูููู ุงูุบุฐุงุฆูุฉ:                  โ
โ   ๐ฅ 450 cal  ๐ช 5g  ๐ 55g         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ๐ฐ ุงูุณุนุฑ: 40 ุฑ.ุณ                    โ
โ        [โ ุฃุถู ููุณูุฉ]               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ ุฎุทุฉ ุงูุชูููุฐ

### Phase 1: Database Updates (ุงูุฃููููุฉ ุงูุนุงููุฉ)
1. โ ุฅุถุงูุฉ ุฌุฏูู `product_sizes`
2. โ ุฅุถุงูุฉ ุฌุฏูู `container_types`
3. โ ุฅุถุงูุฉ ุนููุฏ `product_type` ููููุชุฌุงุช
4. โ ุฅุถุงูุฉ ุนููุฏ `has_sizes` ู `has_container_choice`
5. โ Seed data ููููุงุณุงุช ูุงูุญุงููุงุช

### Phase 2: Backend API Updates
1. โ Endpoint ูุฌูุจ ุงูููุงุณุงุช: `GET /products/:id/sizes`
2. โ Endpoint ูุฌูุจ ุงูุญุงููุงุช: `GET /products/:id/containers`
3. โ ุชุญุฏูุซ `customization-rules` ููุดูู ุงูููุงุณุงุช ูุงูุญุงููุงุช
4. โ ุชุญุฏูุซ ุญุณุงุจ ุงูุณุนุฑ ููุดูู ุงูููุงุณ ูุงูุญุงููุฉ

### Phase 3: Frontend Components
1. โ `SizeSelector` component
2. โ `ContainerSelector` component
3. โ ุชุญุฏูุซ `useCustomization` hook
4. โ ุชุญุฏูุซ `ProductModal` ู `RichProductPage`

### Phase 4: Product Templates
1. โ `BYOIceCreamTemplate`
2. โ `PresetIceCreamTemplate`
3. โ `MilkshakeTemplate`
4. โ `StandardProductTemplate`
5. โ Template Router (ูุฎุชุงุฑ ุงููุงูุจ ุงูููุงุณุจ)

### Phase 5: Cart & Checkout Updates
1. โ ุชุญุฏูุซ `CartProvider` ูุฏุนู ุงูููุงุณุงุช ูุงูุญุงููุงุช
2. โ ุชุญุฏูุซ `CartItem` ูุนุฑุถ ุงูุชูุงุตูู
3. โ ุชุญุฏูุซ `orderService` ูุญูุธ ุงูุจูุงูุงุช

---

## ๐ฏ ุงูููู ุงูุบุฐุงุฆูุฉ - ุงูุงุณุชุฑุงุชูุฌูุฉ

### ููุขูุณ ูุฑูู ุงููุฎุตุต (BYO):
- **ุงูุญุงููุฉ:** ุงูููู ูู ุณุนุฑุงุช (โ50 cal)ุ ุงูููุจ = 0
- **ุงูููุงุณ:** ูุถุงุนู (ุตุบูุฑ x0.7ุ ูุณุท x1ุ ูุจูุฑ x1.5)
- **ุงููููุงุช:** ุชูุฌูุน ูู ุงูุงุฎุชูุงุฑุงุช
- **ุงูุตูุตุงุช ูุงูุฅุถุงูุงุช:** ุชูุถุงู ูููุฌููุน

```
Total Nutrition = (Container Nutrition) + 
                  (Sum of Flavors ร Size Multiplier) + 
                  (Sum of Sauces) + 
                  (Sum of Toppings)
```

### ููุขูุณ ูุฑูู ุงูุฌุงูุฒ:
- **ุงูููุชุฌ ุงูุฃุณุงุณู:** ููู ุซุงุจุชุฉ
- **ุงูููุงุณ:** ูุถุงุนู
- **ุงูุฅุถุงูุงุช:** ุชูุถุงู ูููุฌููุน

```
Total Nutrition = (Base Product ร Size Multiplier) + 
                  (Sum of Addons)
```

---

## ๐ ูููู ุงููููุงุช ุงูููุชุฑุญ

```
src/
โโโ components/
โ   โโโ product-templates/
โ   โ   โโโ BYOIceCreamTemplate.tsx
โ   โ   โโโ PresetIceCreamTemplate.tsx
โ   โ   โโโ MilkshakeTemplate.tsx
โ   โ   โโโ StandardProductTemplate.tsx
โ   โ   โโโ TemplateRouter.tsx
โ   โโโ selectors/
โ   โ   โโโ SizeSelector.tsx
โ   โ   โโโ ContainerSelector.tsx
โ   โ   โโโ FlavorSelector.tsx
โ   โ   โโโ AddonSelector.tsx
โ   โโโ modals/
โ       โโโ ProductModal/
โ           โโโ index.tsx (ูุณุชุฎุฏู TemplateRouter)
โ           โโโ ...
โโโ hooks/
โ   โโโ useProductCustomization.ts (unified hook)
โ   โโโ useSizes.ts
โ   โโโ useContainers.ts
โโโ types/
    โโโ product.ts (TypeScript interfaces)
```

---

## โ ุงูุฎุทูุฉ ุงูุชุงููุฉ

**ุงูุณุคุงู:** ุฃู Phase ูุจุฏุฃ ุจููุงุ

### ุงูุชุฑุงุญู:
1. **Phase 1 (Database)** - ุงูุฃุณุงุณ ููู ุดูุก
2. **Phase 2 (Backend)** - APIs ุฌุงูุฒุฉ ููู Frontend
3. **Phase 3 + 4 (Frontend)** - ุจุงูุชูุงุฒู

### ุงููุทููุจ ููู:
1. โ ุชุฃููุฏ ุงูุฎุทุฉ
2. โ ุชุญุฏูุฏ ุงูููุงุณุงุช ูุงูุฃุณุนุงุฑ ุงููุนููุฉ
3. โ ุชุญุฏูุฏ ุฃู ููุชุฌุงุช ุชุญุชุงุฌ ููุงุณุงุช
4. โ ุชุญุฏูุฏ ุงูููู ุงูุบุฐุงุฆูุฉ ููููู

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูููู (Cone):** ูู ููู ุบุฐุงุฆูุฉ (โ50 cal, 10g carbs)
2. **ุงูููุจ:** ูุง ููู ุบุฐุงุฆูุฉ (0)
3. **ุงูููุงุณุงุช:** ุชุคุซุฑ ุนูู ุงูุณุนุฑ ูุงููููุฉ ูุงูููู ุงูุบุฐุงุฆูุฉ
4. **ุงูุชูุงูู:** ุงููุธุงู ุงูุฌุฏูุฏ ูุฌุจ ุฃู ูุนูู ูุน ุงูููุชุฌุงุช ุงููุฏููุฉ

---

**ุฌุงูุฒ ููุชูููุฐ! ๐**
